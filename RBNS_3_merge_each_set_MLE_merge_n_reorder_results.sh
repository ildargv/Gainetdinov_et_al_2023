#MILI, MIWI, and EfPiwi library names allow the script below to separate concentrations:
Input_id6_Second_vial_library_Nov1420.fastq.gz

P0_i27_MILI_Let726501003_Rep1_52022_pi06.fastq.gz
R1_i21_MILI_Let726501003_Rep1_52022_pi06.fastq.gz
R2_i22_MILI_Let726501003_Rep1_52022_pi06.fastq.gz
R3_i23_MILI_Let726501003_Rep1_52022_pi06.fastq.gz
R4_i24_MILI_Let726501003_Rep1_52022_pi06.fastq.gz
R5_i25_MILI_Let726501003_Rep1_52022_pi06.fastq.gz
R6_i26_MILI_Let726501003_Rep1_52022_pi06.fastq.gz

P0_i7_MILI_Let726501003_Rep2_062122_pi07.fastq.gz
R1_i1_MILI_Let726501003_Rep2_062122_pi07.fastq.gz
R2_i2_MILI_Let726501003_Rep2_062122_pi07.fastq.gz
R3_i3_MILI_Let726501003_Rep2_062122_pi07.fastq.gz
R4_i4_MILI_Let726501003_Rep2_062122_pi07.fastq.gz
R5_i5_MILI_Let726501003_Rep2_062122_pi07.fastq.gz
R6_i6_MILI_Let726501003_Rep2_062122_pi07.fastq.gz

P0_id20_mouse_MIWI_Let7_Rep1_042722_pi02.fastq.gz
R1_id1_mouse_MIWI_Let7_Rep1_042722_pi02.fastq.gz
R2_id2_mouse_MIWI_Let7_Rep1_042722_pi02.fastq.gz
R3_id3_mouse_MIWI_Let7_Rep1_042722_pi02.fastq.gz
R4_id4_mouse_MIWI_Let7_Rep1_042722_pi02.fastq.gz
R5_id5_mouse_MIWI_Let7_Rep1_042722_pi02.fastq.gz
R6_id6_mouse_MIWI_Let7_Rep1_042722_pi02.fastq.gz

P0_id21_mouse_MIWI_Let7_Rep2_042722_pi03.fastq.gz
R1_id7_mouse_MIWI_Let7_Rep2_042722_pi03.fastq.gz
R2_id8_mouse_MIWI_Let7_Rep2_042722_pi03.fastq.gz
R3_id9_mouse_MIWI_Let7_Rep2_042722_pi03.fastq.gz
R4_id10_mouse_MIWI_Let7_Rep2_042722_pi03.fastq.gz
R5_id11_mouse_MIWI_Let7_Rep2_042722_pi03.fastq.gz
R6_id12_mouse_MIWI_Let7_Rep2_042722_pi03.fastq.gz

P0_i7_MIWI3057_1006_Rep2_052022_pi05.fastq.gz
R1_i1_MIWI3057_1006_Rep2_052022_pi05.fastq.gz
R2_i2_MIWI3057_1006_Rep2_052022_pi05.fastq.gz
R3_i3_MIWI3057_1006_Rep2_052022_pi05.fastq.gz
R4_i4_MIWI3057_1006_Rep2_052022_pi05.fastq.gz
R5_i5_MIWI3057_1006_Rep2_052022_pi05.fastq.gz
R6_i6_MIWI3057_1006_Rep2_052022_pi05.fastq.gz

P0_id31_MIWI3057_1007_Rep1_051122_pi04.fastq.gz
R1_id25_MIWI3057_1007_Rep1_051122_pi04.fastq.gz
R2_id26_MIWI3057_1007_Rep1_051122_pi04.fastq.gz
R3_id27_MIWI3057_1007_Rep1_051122_pi04.fastq.gz
R4_id28_MIWI3057_1007_Rep1_051122_pi04.fastq.gz
R5_id29_MIWI3057_1007_Rep1_051122_pi04.fastq.gz
R6_id30_MIWI3057_1007_Rep1_051122_pi04.fastq.gz

P0_i7_MIWI_L1MC_Rp3_120222_pi13.fastq.gz
R1_i1_MIWI_L1MC_Rp3_120222_pi13.fastq.gz
R2_i2_MIWI_L1MC_Rp3_120222_pi13.fastq.gz
R3_i3_MIWI_L1MC_Rp3_120222_pi13.fastq.gz
R4_i4_MIWI_L1MC_Rp3_120222_pi13.fastq.gz
R5_i5_MIWI_L1MC_Rp3_120222_pi13.fastq.gz
R6_i6_MIWI_L1MC_Rp3_120222_pi13.fastq.gz

P0_i27_MILI_L1MC_2657_Rp3_110222_pi12.fastq.gz
R1_i21_MILI_L1MC_2657_Rp3_110222_pi12.fastq.gz
R2_i22_MILI_L1MC_2657_Rp3_110222_pi12.fastq.gz
R3_i23_MILI_L1MC_2657_Rp3_110222_pi12.fastq.gz
R4_i24_MILI_L1MC_2657_Rp3_110222_pi12.fastq.gz
R5_i25_MILI_L1MC_2657_Rp3_110222_pi12.fastq.gz
R6_i26_MILI_L1MC_2657_Rp3_110222_pi12.fastq.gz

P0_i7_MILI_L1MC_2657_Rp2_110222_pi11.fastq.gz
R1_i1_MILI_L1MC_2657_Rp2_110222_pi11.fastq.gz
R2_i2_MILI_L1MC_2657_Rp2_110222_pi11.fastq.gz
R3_i3_MILI_L1MC_2657_Rp2_110222_pi11.fastq.gz
R4_i4_MILI_L1MC_2657_Rp2_110222_pi11.fastq.gz
R5_i5_MILI_L1MC_2657_Rp2_110222_pi11.fastq.gz
R6_i6_MILI_L1MC_2657_Rp2_110222_pi11.fastq.gz

P0_i33_MILI_L1MC_2657_Rp1_101722_pi10.fastq.gz
R1_i27_MILI_L1MC_2657_Rp1_101722_pi10.fastq.gz
R2_i28_MILI_L1MC_2657_Rp1_101722_pi10.fastq.gz
R3_i29_MILI_L1MC_2657_Rp1_101722_pi10.fastq.gz
R4_i30_MILI_L1MC_2657_Rp1_101722_pi10.fastq.gz
R5_i31_MILI_L1MC_2657_Rp1_101722_pi10.fastq.gz
R6_i32_MILI_L1MC_2657_Rp1_101722_pi10.fastq.gz

P0_i7_EfPiwi_Let7_Rp3_012723_pi18.fastq.gz
R1_i1_EfPiwi_Let7_Rp3_012723_pi18.fastq.gz
R2_i2_EfPiwi_Let7_Rp3_012723_pi18.fastq.gz
R3_i3_EfPiwi_Let7_Rp3_012723_pi18.fastq.gz
R4_i4_EfPiwi_Let7_Rp3_012723_pi18.fastq.gz
R5_i5_EfPiwi_Let7_Rp3_012723_pi18.fastq.gz
R6_i6_EfPiwi_Let7_Rp3_012723_pi18.fastq.gz

P0_i27_EfPiwi_Let7_Rp2_012323_pi17.fastq.gz
R1_i21_EfPiwi_Let7_Rp2_012323_pi17.fastq.gz
R2_i22_EfPiwi_Let7_Rp2_012323_pi17.fastq.gz
R3_i23_EfPiwi_Let7_Rp2_012323_pi17.fastq.gz
R4_i24_EfPiwi_Let7_Rp2_012323_pi17.fastq.gz
R5_i25_EfPiwi_Let7_Rp2_012323_pi17.fastq.gz
R6_i26_EfPiwi_Let7_Rp2_012323_pi17.fastq.gz

P0_i7_EfPiwi_Let7_Rp1_012323_pi16.fastq.gz
R1_i1_EfPiwi_Let7_Rp1_012323_pi16.fastq.gz
R2_i2_EfPiwi_Let7_Rp1_012323_pi16.fastq.gz
R3_i3_EfPiwi_Let7_Rp1_012323_pi16.fastq.gz
R4_i4_EfPiwi_Let7_Rp1_012323_pi16.fastq.gz
R5_i5_EfPiwi_Let7_Rp1_012323_pi16.fastq.gz
R6_i6_EfPiwi_Let7_Rp1_012323_pi16.fastq.gz

P0_i27_Mmu_AGO2_Let7_Rp3_012723_pi19.fastq.gz
R1_i21_Mmu_AGO2_Let7_Rp3_012723_pi19.fastq.gz
R2_i22_Mmu_AGO2_Let7_Rp3_012723_pi19.fastq.gz
R3_i23_Mmu_AGO2_Let7_Rp3_012723_pi19.fastq.gz
R4_i24_Mmu_AGO2_Let7_Rp3_012723_pi19.fastq.gz
R5_i25_Mmu_AGO2_Let7_Rp3_012723_pi19.fastq.gz
R6_i26_Mmu_AGO2_Let7_Rp3_012723_pi19.fastq.gz

P0_i27_MILI_Let7_Rp3_120222_pi14.fastq.gz
R1_i21_MILI_Let7_Rp3_120222_pi14.fastq.gz
R2_i22_MILI_Let7_Rp3_120222_pi14.fastq.gz
R3_i23_MILI_Let7_Rp3_120222_pi14.fastq.gz
R4_i24_MILI_Let7_Rp3_120222_pi14.fastq.gz
R5_i25_MILI_Let7_Rp3_120222_pi14.fastq.gz
R6_i26_MILI_Let7_Rp3_120222_pi14.fastq.gz

P0_i26_MIWI_Let7_30501003_Rp3_101722_pi9.fastq.gz
R1_i20_MIWI_Let7_30501003_Rp3_101722_pi9.fastq.gz
R2_i21_MIWI_Let7_30501003_Rp3_101722_pi9.fastq.gz
R3_i22_MIWI_Let7_30501003_Rp3_101722_pi9.fastq.gz
R4_i23_MIWI_Let7_30501003_Rp3_101722_pi9.fastq.gz
R5_i24_MIWI_Let7_30501003_Rp3_101722_pi9.fastq.gz
R6_i25_MIWI_Let7_30501003_Rp3_101722_pi9.fastq.gz

#2.merge each Kmer and t1N_g2_Kmer for MILI and MIWI
for type in Kmer t1N_g2_Kmer; do awk 'BEGIN{FS=OFS="\t"}{sites[$1]=1;data[$1,substr(FILENAME,2,1)]=$2}END{print "site\tInput\t0\t0.003\t0.010\t0.032\t0.100\t0.316\t1";for (site in sites){print site"\t"data[site,"n"]"\t"data[site,"0"]"\t"data[site,"6"]"\t"data[site,"5"]"\t"data[site,"4"]"\t"data[site,"3"]"\t"data[site,"2"]"\t"data[site,"1"]}}' input.trimmed.$type.types *Rep1*.$type.types > $type.rep1.counts;
awk 'BEGIN{FS=OFS="\t"}{sites[$1]=1;data[$1,substr(FILENAME,2,1)]=$2}END{print "site\tInput\t0\t0.003\t0.010\t0.032\t0.100\t0.316\t1";for (site in sites){print site"\t"data[site,"n"]"\t"data[site,"0"]"\t"data[site,"6"]"\t"data[site,"5"]"\t"data[site,"4"]"\t"data[site,"3"]"\t"data[site,"2"]"\t"data[site,"1"]}}' input.trimmed.$type.types *Rep2*.$type.types > $type.rep2.counts; 
done

#3.rename libraries as follows: AGO2/MILI/MIWI/EfPiwi - 21/26/30/Ep; piRNA1/L1MC - 50/57

#4.MLE on workstation for Kmer and t1N_g2_Kmer
for type in 21.50.Kmer.rep1 21.50.Kmer.rep2 21.50.Kmer.rep3 26.50.Kmer.rep1 26.50.Kmer.rep2 26.50.Kmer.rep3 30.50.Kmer.rep1 30.50.Kmer.rep2 30.50.Kmer.rep3 Ep.50.Kmer.rep1 Ep.50.Kmer.rep2 Ep.50.Kmer.rep3 26.57.Kmer.rep1 26.57.Kmer.rep2 26.57.Kmer.rep3 30.57.Kmer.rep1 30.57.Kmer.rep2 30.57.Kmer.rep3 21.50.t1N_g2_Kmer.rep1 21.50.t1N_g2_Kmer.rep2 21.50.t1N_g2_Kmer.rep3 26.50.t1N_g2_Kmer.rep1 26.50.t1N_g2_Kmer.rep2 26.50.t1N_g2_Kmer.rep3 30.50.t1N_g2_Kmer.rep1 30.50.t1N_g2_Kmer.rep2 30.50.t1N_g2_Kmer.rep3 Ep.50.t1N_g2_Kmer.rep1 Ep.50.t1N_g2_Kmer.rep2 Ep.50.t1N_g2_Kmer.rep3 26.57.t1N_g2_Kmer.rep1 26.57.t1N_g2_Kmer.rep2 26.57.t1N_g2_Kmer.rep3 30.57.t1N_g2_Kmer.rep1 30.57.t1N_g2_Kmer.rep2 30.57.t1N_g2_Kmer.rep3;
do for piRISC in 0.1 0.2 0.5 1 2 5 10;
do for KD in 0.1 0.2 0.5 1 2 5 10;
do python2 ./MLE_KD.py ./ $type.counts 100 $piRISC $KD 0; done; done; done